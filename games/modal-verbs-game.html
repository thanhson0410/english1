<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Modal Verbs Master - Game Luy·ªán T·∫≠p ƒê·ªông T·ª´ Khuy·∫øt Thi·∫øu</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .modal-type {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .scenario-box {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .confidence-indicator {
            height: 20px;
            background: linear-gradient(to right, #ff4757, #ffa502, #2ed573);
            border-radius: 10px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        .confidence-marker {
            position: absolute;
            top: 0;
            width: 4px;
            height: 100%;
            background: #333;
            transition: left 0.3s ease;
        }
        
        .answer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .modal-option {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .modal-option:hover {
            border-color: #007bff;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,123,255,0.3);
        }
        
        .modal-option.selected {
            border-color: #007bff;
            background: #e3f2fd;
            transform: scale(1.05);
        }
        
        .modal-option.correct {
            border-color: #28a745;
            background: #d4edda;
            animation: correctPulse 0.6s ease;
        }
        
        .modal-option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
            animation: shake 0.5s ease;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .modal-meaning {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            z-index: 10000;
            display: none;
            animation: achievementBounce 0.8s ease;
        }
        
        @keyframes achievementBounce {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .streak-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            z-index: 1000;
            animation: streakPulse 2s infinite ease-in-out;
        }
        
        @keyframes streakPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @media (max-width: 768px) {
            .answer-grid {
                grid-template-columns: 1fr;
            }
            
            .game-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-option {
                min-height: 60px;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>üîß Modal Verbs Master</h1>
        <p>Game Luy·ªán T·∫≠p ƒê·ªông T·ª´ Khuy·∫øt Thi·∫øu</p>
        <nav>
            <ul>
                <li><a href="../index.html">üè† Trang Ch·ªß</a></li>
                <li><a href="../grammar-lessons/lessons.html">üìö B√†i H·ªçc</a></li>
                <li><a href="games.html">üéÆ Tr√≤ Ch∆°i</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="streak-counter" id="streakCounter" style="display: none;">
            üî• Streak: <span id="streakNumber">0</span>
        </div>

        <section class="game-mode-selection" id="gameModeSection">
            <h2>üéØ Ch·ªçn Ch·∫ø ƒê·ªô Ch∆°i</h2>
            <div class="game-mode-grid">
                <button class="game-mode-btn" onclick="startGame('basics')">
                    <h3>üéì C∆° B·∫£n</h3>
                    <p>Can, Could, May, Might</p>
                    <small>Kh·∫£ nƒÉng & Xin ph√©p</small>
                </button>
                <button class="game-mode-btn" onclick="startGame('advice')">
                    <h3>üí° L·ªùi Khuy√™n</h3>
                    <p>Should, Ought to, Had better</p>
                    <small>Khuy√™n b·∫£o & G·ª£i √Ω</small>
                </button>
                <button class="game-mode-btn" onclick="startGame('necessity')">
                    <h3>‚ö° C·∫ßn Thi·∫øt</h3>
                    <p>Must, Have to, Need to</p>
                    <small>B·∫Øt bu·ªôc & Nghƒ©a v·ª•</small>
                </button>
                <button class="game-mode-btn" onclick="startGame('mixed')">
                    <h3>üèÜ T·ªïng H·ª£p</h3>
                    <p>T·∫•t c·∫£ Modal Verbs</p>
                    <small>Th·ª≠ th√°ch cao c·∫•p</small>
                </button>
                <button class="game-mode-btn" onclick="startGame('scenarios')">
                    <h3>üé≠ T√¨nh Hu·ªëng</h3>
                    <p>√Åp d·ª•ng v√†o ng·ªØ c·∫£nh</p>
                    <small>Th·ª±c t·∫ø & Giao ti·∫øp</small>
                </button>
                <button class="game-mode-btn" onclick="startGame('speed')">
                    <h3>‚ö° T·ªëc ƒê·ªô</h3>
                    <p>Th√°ch th·ª©c 60 gi√¢y</p>
                    <small>Ph·∫£n x·∫° nhanh</small>
                </button>
            </div>
        </section>

        <section class="game-play" id="gamePlaySection" style="display: none;">
            <div class="game-stats">
                <div class="stat-card">
                    <h4>üìä ƒêi·ªÉm S·ªë</h4>
                    <div class="score" id="scoreDisplay">0</div>
                </div>
                <div class="stat-card">
                    <h4>‚ùì C√¢u H·ªèi</h4>
                    <div id="questionNumber">1/10</div>
                </div>
                <div class="stat-card">
                    <h4>‚è±Ô∏è Th·ªùi Gian</h4>
                    <div id="timeDisplay">--</div>
                </div>
                <div class="stat-card">
                    <h4>üéØ ƒê·ªô Ch√≠nh X√°c</h4>
                    <div id="accuracyDisplay">100%</div>
                </div>
            </div>

            <div class="modal-type" id="modalTypeDisplay"></div>

            <div class="question-container">
                <h3 id="questionText">Ch·ªçn modal verb ph√π h·ª£p:</h3>
                <div class="scenario-box" id="scenarioBox" style="display: none;">
                    <strong>T√¨nh hu·ªëng:</strong> <span id="scenarioText"></span>
                </div>
                <div class="sentence-display" id="sentenceDisplay"></div>
                
                <div class="confidence-indicator" id="confidenceIndicator" style="display: none;">
                    <div class="confidence-marker" id="confidenceMarker"></div>
                </div>

                <div class="answer-grid" id="answerGrid"></div>

                <div class="explanation-box" id="explanationBox" style="display: none;">
                    <h4>üí° Gi·∫£i Th√≠ch:</h4>
                    <p id="explanationText"></p>
                </div>

                <div class="game-controls">
                    <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                        C√¢u Ti·∫øp Theo ‚û°Ô∏è
                    </button>
                    <button class="btn btn-secondary" onclick="showHint()" id="hintBtn">
                        üí° G·ª£i √ù
                    </button>
                </div>
            </div>
        </section>

        <section class="game-results" id="gameResultsSection" style="display: none;">
            <div class="results-container">
                <h2 id="resultsTitle">üéâ Ho√†n Th√†nh!</h2>
                <div class="final-score" id="finalScore"></div>
                <div class="star-rating" id="starRating"></div>
                
                <div class="results-stats">
                    <div class="result-stat">
                        <span>T·ªïng c√¢u h·ªèi:</span>
                        <span id="totalQuestions">10</span>
                    </div>
                    <div class="result-stat">
                        <span>Tr·∫£ l·ªùi ƒë√∫ng:</span>
                        <span id="correctAnswers">0</span>
                    </div>
                    <div class="result-stat">
                        <span>ƒê·ªô ch√≠nh x√°c:</span>
                        <span id="finalAccuracy">0%</span>
                    </div>
                    <div class="result-stat">
                        <span>Th·ªùi gian:</span>
                        <span id="totalTime">0s</span>
                    </div>
                </div>

                <div class="achievements" id="achievementsDisplay"></div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="resetGame()">üîÑ Ch∆°i L·∫°i</button>
                    <button class="btn btn-secondary" onclick="location.href='games.html'">üéÆ Game Kh√°c</button>
                    <button class="btn btn-secondary" onclick="location.href='../grammar-lessons/modal-verbs.html'">üìö √în L√Ω Thuy·∫øt</button>
                </div>
            </div>
        </section>

        <div class="achievement-popup" id="achievementPopup">
            <h3 id="achievementTitle">üèÜ Th√†nh T√≠ch M·ªõi!</h3>
            <p id="achievementDescription"></p>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 English Grammar Mastery - Modal Verbs Master Game</p>
    </footer>

    <script>
        // Game variables
        let currentGameMode = '';
        let currentQuestion = 0;
        let score = 0;
        let correctAnswers = 0;
        let totalQuestions = 10;
        let timeLeft = 60;
        let gameTimer = null;
        let startTime = null;
        let streak = 0;
        let maxStreak = 0;
        let questions = [];
        let isAnswered = false;

        // Question sets for different game modes
        const questionSets = {
            basics: [
                {
                    sentence: "I ___ speak three languages fluently.",
                    options: ["can", "could", "may", "might"],
                    correct: 0,
                    explanation: "'Can' di·ªÖn t·∫£ kh·∫£ nƒÉng hi·ªán t·∫°i. 'Could' l√† qu√° kh·ª© c·ªßa 'can'.",
                    type: "Kh·∫£ NƒÉng (Ability)"
                },
                {
                    sentence: "___ I borrow your pen?",
                    options: ["Can", "Could", "May", "Might"],
                    correct: 1,
                    explanation: "'Could' l·ªãch s·ª± h∆°n 'can' khi xin ph√©p.",
                    type: "Xin Ph√©p (Permission)"
                },
                {
                    sentence: "It ___ rain tomorrow. The forecast is uncertain.",
                    options: ["can", "could", "may", "might"],
                    correct: 3,
                    explanation: "'Might' di·ªÖn t·∫£ kh·∫£ nƒÉng th·∫•p, kh√¥ng ch·∫Øc ch·∫Øn.",
                    type: "Kh·∫£ NƒÉng (Possibility)"
                },
                {
                    sentence: "When I was young, I ___ run very fast.",
                    options: ["can", "could", "may", "might"],
                    correct: 1,
                    explanation: "'Could' di·ªÖn t·∫£ kh·∫£ nƒÉng trong qu√° kh·ª©.",
                    type: "Kh·∫£ NƒÉng Qu√° Kh·ª©"
                },
                {
                    sentence: "___ you help me with this problem?",
                    options: ["Can", "Could", "May", "Might"],
                    correct: 0,
                    explanation: "'Can' d√πng ƒë·ªÉ nh·ªù gi√∫p ƒë·ª° m·ªôt c√°ch th√¢n thi·ªán.",
                    type: "Nh·ªù Gi√∫p ƒê·ª°"
                }
            ],
            advice: [
                {
                    sentence: "You ___ see a doctor about that cough.",
                    options: ["should", "ought to", "had better", "must"],
                    correct: 0,
                    explanation: "'Should' ƒë∆∞a ra l·ªùi khuy√™n m·∫°nh m·∫Ω nh∆∞ng kh√¥ng b·∫Øt bu·ªôc.",
                    type: "L·ªùi Khuy√™n"
                },
                {
                    sentence: "Students ___ submit their essays by Friday.",
                    options: ["should", "ought to", "had better", "might"],
                    correct: 1,
                    explanation: "'Ought to' di·ªÖn t·∫£ nghƒ©a v·ª• ƒë·∫°o ƒë·ª©c ho·∫∑c quy ƒë·ªãnh.",
                    type: "Nghƒ©a V·ª•"
                },
                {
                    sentence: "You ___ leave now if you want to catch the last train.",
                    options: ["should", "ought to", "had better", "could"],
                    correct: 2,
                    explanation: "'Had better' ƒë∆∞a ra l·ªùi khuy√™n v·ªõi h·∫≠u qu·∫£ n·∫øu kh√¥ng l√†m theo.",
                    type: "L·ªùi Khuy√™n C·∫£nh B√°o"
                }
            ],
            necessity: [
                {
                    sentence: "You ___ wear a seatbelt while driving.",
                    options: ["must", "have to", "need to", "should"],
                    correct: 0,
                    explanation: "'Must' di·ªÖn t·∫£ b·∫Øt bu·ªôc t·ª´ ng∆∞·ªùi n√≥i ho·∫∑c lu·∫≠t ph√°p.",
                    type: "B·∫Øt Bu·ªôc"
                },
                {
                    sentence: "I ___ go to work early tomorrow.",
                    options: ["must", "have to", "need to", "should"],
                    correct: 1,
                    explanation: "'Have to' di·ªÖn t·∫£ b·∫Øt bu·ªôc t·ª´ ho√†n c·∫£nh b√™n ngo√†i.",
                    type: "B·∫Øt Bu·ªôc B√™n Ngo√†i"
                },
                {
                    sentence: "We ___ finish this project by Monday.",
                    options: ["must", "have to", "need to", "should"],
                    correct: 2,
                    explanation: "'Need to' di·ªÖn t·∫£ s·ª± c·∫ßn thi·∫øt.",
                    type: "S·ª± C·∫ßn Thi·∫øt"
                }
            ],
            scenarios: [
                {
                    scenario: "B·∫°n ƒëang ·ªü th∆∞ vi·ªán v√† mu·ªën m∆∞·ª£n s√°ch c·ªßa b·∫°n b√®",
                    sentence: "___ I borrow your book for a moment?",
                    options: ["Can", "Could", "May", "Might"],
                    correct: 1,
                    explanation: "Trong t√¨nh hu·ªëng l·ªãch s·ª±, 'Could' ph√π h·ª£p nh·∫•t.",
                    type: "Giao Ti·∫øp L·ªãch S·ª±"
                },
                {
                    scenario: "B√°c sƒ© ƒëang t∆∞ v·∫•n cho b·ªánh nh√¢n v·ªÅ ch·∫ø ƒë·ªô ƒÉn",
                    sentence: "You ___ eat more vegetables and less sugar.",
                    options: ["can", "should", "may", "might"],
                    correct: 1,
                    explanation: "B√°c sƒ© ƒë∆∞a ra l·ªùi khuy√™n chuy√™n m√¥n v·ªõi 'should'.",
                    type: "L·ªùi Khuy√™n Chuy√™n M√¥n"
                }
            ]
        };

        function startGame(mode) {
            currentGameMode = mode;
            currentQuestion = 0;
            score = 0;
            correctAnswers = 0;
            streak = 0;
            maxStreak = 0;
            startTime = Date.now();
            
            // Set questions based on mode
            switch(mode) {
                case 'speed':
                    totalQuestions = 15;
                    timeLeft = 60;
                    startTimer();
                    break;
                case 'mixed':
                    totalQuestions = 15;
                    questions = shuffleArray([...questionSets.basics, ...questionSets.advice, ...questionSets.necessity]);
                    break;
                default:
                    totalQuestions = 10;
                    questions = shuffleArray(questionSets[mode] || questionSets.basics);
            }
            
            if (mode === 'mixed') {
                questions = questions.slice(0, totalQuestions);
            }
            
            document.getElementById('gameModeSection').style.display = 'none';
            document.getElementById('gamePlaySection').style.display = 'block';
            
            if (mode === 'speed') {
                document.getElementById('streakCounter').style.display = 'block';
            }
            
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestion >= totalQuestions) {
                endGame();
                return;
            }
            
            isAnswered = false;
            const question = questions[currentQuestion];
            
            // Update UI
            document.getElementById('questionNumber').textContent = `${currentQuestion + 1}/${totalQuestions}`;
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('accuracyDisplay').textContent = 
                Math.round((correctAnswers / Math.max(currentQuestion, 1)) * 100) + '%';
            
            // Show question type
            document.getElementById('modalTypeDisplay').textContent = question.type;
            
            // Show scenario if exists
            if (question.scenario) {
                document.getElementById('scenarioBox').style.display = 'block';
                document.getElementById('scenarioText').textContent = question.scenario;
            } else {
                document.getElementById('scenarioBox').style.display = 'none';
            }
            
            // Show sentence
            document.getElementById('sentenceDisplay').innerHTML = 
                `<h3>"${question.sentence}"</h3>`;
            
            // Create answer options
            const answerGrid = document.getElementById('answerGrid');
            answerGrid.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'modal-option';
                optionDiv.onclick = () => selectAnswer(index);
                
                optionDiv.innerHTML = `
                    <strong>${option}</strong>
                    <div class="modal-meaning">${getModalMeaning(option)}</div>
                `;
                
                answerGrid.appendChild(optionDiv);
            });
            
            // Hide explanation and next button
            document.getElementById('explanationBox').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('hintBtn').style.display = 'inline-block';
        }

        function getModalMeaning(modal) {
            const meanings = {
                'can': 'c√≥ th·ªÉ, kh·∫£ nƒÉng',
                'could': 'c√≥ th·ªÉ (l·ªãch s·ª±/qu√° kh·ª©)',
                'may': 'c√≥ th·ªÉ, xin ph√©p',
                'might': 'c√≥ l·∫Ω, kh·∫£ nƒÉng th·∫•p',
                'must': 'ph·∫£i, b·∫Øt bu·ªôc',
                'should': 'n√™n, l·ªùi khuy√™n',
                'ought to': 'n√™n, nghƒ©a v·ª•',
                'had better': 't·ªët h∆°n n√™n',
                'have to': 'ph·∫£i (b√™n ngo√†i)',
                'need to': 'c·∫ßn ph·∫£i'
            };
            return meanings[modal.toLowerCase()] || '';
        }

        function selectAnswer(selectedIndex) {
            if (isAnswered) return;
            
            isAnswered = true;
            const question = questions[currentQuestion];
            const options = document.querySelectorAll('.modal-option');
            
            // Remove previous classes
            options.forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selected answer
            options[selectedIndex].classList.add('selected');
            
            if (selectedIndex === question.correct) {
                options[selectedIndex].classList.add('correct');
                correctAnswers++;
                score += calculateScore();
                streak++;
                maxStreak = Math.max(maxStreak, streak);
                
                // Update streak counter
                if (currentGameMode === 'speed') {
                    document.getElementById('streakNumber').textContent = streak;
                }
                
                // Check for achievements
                checkAchievements();
                
                playSound('correct');
            } else {
                options[selectedIndex].classList.add('incorrect');
                options[question.correct].classList.add('correct');
                streak = 0;
                playSound('incorrect');
            }
            
            // Show explanation
            document.getElementById('explanationText').textContent = question.explanation;
            document.getElementById('explanationBox').style.display = 'block';
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('hintBtn').style.display = 'none';
        }

        function calculateScore() {
            let baseScore = 10;
            if (currentGameMode === 'speed') baseScore += Math.max(0, timeLeft);
            if (streak > 2) baseScore += streak * 2;
            return baseScore;
        }

        function nextQuestion() {
            currentQuestion++;
            loadQuestion();
        }

        function showHint() {
            const question = questions[currentQuestion];
            const hintTexts = {
                "Kh·∫£ NƒÉng (Ability)": "Suy nghƒ© v·ªÅ kh·∫£ nƒÉng hi·ªán t·∫°i hay qu√° kh·ª©",
                "Xin Ph√©p (Permission)": "C√°ch n√†o l·ªãch s·ª± h∆°n?",
                "L·ªùi Khuy√™n": "ƒê√¢y c√≥ ph·∫£i l·ªùi khuy√™n kh√¥ng?",
                "B·∫Øt Bu·ªôc": "ƒêi·ªÅu n√†y c√≥ b·∫Øt bu·ªôc kh√¥ng?"
            };
            
            alert(hintTexts[question.type] || "ƒê·ªçc k·ªπ ng·ªØ c·∫£nh c·ªßa c√¢u!");
        }

        function startTimer() {
            gameTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timeDisplay').textContent = timeLeft + 's';
                
                if (timeLeft <= 0) {
                    clearInterval(gameTimer);
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            if (gameTimer) clearInterval(gameTimer);
            
            const totalTime = Math.round((Date.now() - startTime) / 1000);
            const accuracy = Math.round((correctAnswers / totalQuestions) * 100);
            
            document.getElementById('gamePlaySection').style.display = 'none';
            document.getElementById('gameResultsSection').style.display = 'block';
            document.getElementById('streakCounter').style.display = 'none';
            
            // Show results
            document.getElementById('finalScore').textContent = score;
            document.getElementById('totalQuestions').textContent = totalQuestions;
            document.getElementById('correctAnswers').textContent = correctAnswers;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            document.getElementById('totalTime').textContent = totalTime + 's';
            
            // Show star rating
            showStarRating(accuracy);
            
            // Show achievements
            showFinalAchievements();
        }

        function showStarRating(accuracy) {
            const starContainer = document.getElementById('starRating');
            let stars = 0;
            
            if (accuracy >= 90) stars = 3;
            else if (accuracy >= 70) stars = 2;
            else if (accuracy >= 50) stars = 1;
            
            let starHTML = '';
            for (let i = 0; i < 3; i++) {
                starHTML += i < stars ? '‚≠ê' : '‚òÜ';
            }
            
            starContainer.innerHTML = `<div class="stars">${starHTML}</div>`;
        }

        function checkAchievements() {
            if (streak === 5) {
                showAchievement("üî• Streak Master!", "5 c√¢u ƒë√∫ng li√™n ti·∫øp!");
            } else if (streak === 10) {
                showAchievement("üèÜ Combo King!", "10 c√¢u ƒë√∫ng li√™n ti·∫øp!");
            }
        }

        function showAchievement(title, description) {
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDescription').textContent = description;
            document.getElementById('achievementPopup').style.display = 'block';
            
            setTimeout(() => {
                document.getElementById('achievementPopup').style.display = 'none';
            }, 3000);
        }

        function showFinalAchievements() {
            const achievements = [];
            
            if (correctAnswers === totalQuestions) {
                achievements.push("üéØ Perfect Score - Tr·∫£ l·ªùi ƒë√∫ng 100%!");
            }
            if (maxStreak >= 5) {
                achievements.push("üî• Streak Master - " + maxStreak + " c√¢u ƒë√∫ng li√™n ti·∫øp!");
            }
            if (currentGameMode === 'mixed' && correctAnswers >= 12) {
                achievements.push("üèÜ Modal Expert - Th√†nh th·∫°o t·∫•t c·∫£ modal verbs!");
            }
            
            const achievementContainer = document.getElementById('achievementsDisplay');
            achievementContainer.innerHTML = achievements.length > 0 ? 
                '<h3>üèÜ Th√†nh T√≠ch</h3>' + achievements.map(a => `<div class="achievement">${a}</div>`).join('') : 
                '<p>Ti·∫øp t·ª•c luy·ªán t·∫≠p ƒë·ªÉ m·ªü kh√≥a th√†nh t√≠ch!</p>';
        }

        function resetGame() {
            document.getElementById('gameResultsSection').style.display = 'none';
            document.getElementById('gameModeSection').style.display = 'block';
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function playSound(type) {
            // Audio feedback could be added here
            if (type === 'correct') {
                console.log('üéµ Correct answer sound');
            } else {
                console.log('üéµ Incorrect answer sound');
            }
        }

        // Initialize default questions
        questions = shuffleArray(questionSets.basics);
    </script>
</body>
</html>
